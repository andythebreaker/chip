<!DOCTYPE html>
<html>

<head>
    <title>File Download</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.11/semantic.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.11/semantic.js"></script>

    <style>
        table {
            border-collapse: collapse;
            border: 2px solid black;
            background-color: green;
        }

        th,
        td {
            border: 2px solid black;
            padding: 8px;
        }
    </style>

</head>

<body>
    <table>
        <tr>
            <th>長</th>
            <th>度</th>
            <th>:</th>
            <th id="master">x</th>
            <th>...</th>
        </tr>
        <tr>
            <td>a[1]</td>
            <td>a[2]</td>
            <td>a[3]</td>
            <td>a[4]</td>
            <th>...</th>
        </tr>
        <tr>
            <td>+</td>
            <td>+</td>
            <td>+</td>
            <td>+</td>
            <th>...</th>
        </tr>
        <tr>
            <td>b[1]</td>
            <td>b[2]</td>
            <td>b[3]</td>
            <td>b[4]</td>
            <th>...</th>
        </tr>
        <tr>
            <td>=</td>
            <td>=</td>
            <td>=</td>
            <td>=</td>
            <th>...</th>
        </tr>
        <tr>
            <td>c[1]</td>
            <td>c[2]</td>
            <td>c[3]</td>
            <td>c[4]</td>
            <th>...</th>
        </tr>
    </table>

    <!--<h1>向量對向量加法生成 (檔案請下載後放在根目錄/tool資料夾下) (會生成sv檔案) (標準尺寸 向量尺寸:100 ； 矩陣尺寸(另一側):400 )</h1>
    <h4>向量尺寸</h4>
    <input type="number" id="numUpDown" value="100">
    <h4>矩陣尺寸(另一側)</h4>
    <input type="number" id="numUpDown2" value="400">
    <h4>生成...</h4>
    <button onclick="downloadFile()">Download File</button>-->
    <h1 class="ui header">向量對向量加法生成 (檔案請下載後放在根目錄/tool資料夾下) (會生成sv檔案) (標準尺寸 向量尺寸:100 ； 矩陣尺寸(另一側):400 )</h1>

    <h4 class="ui header">向量尺寸</h4>
    <div class="ui input">
        <input type="number" id="numUpDown" value="100">
    </div>

    <h4 class="ui header">矩陣尺寸(另一側)</h4>
    <div class="ui input">
        <input type="number" id="numUpDown2" value="400">
    </div>
    <br>
    <div class="ui checkbox">
        <input type="checkbox" name="example">
        <label>master with 向量尺寸 (V) or 矩陣尺寸(另一側) (不勾)</label>
    </div>

    <h4 class="ui header">生成...</h4>
    <button class="ui primary button" onclick="downloadFile()">Download File</button>


    <script> var stsw;
        $(document).ready(function () {
            var numUpDown = $("#numUpDown");
            var numUpDown2 = $("#numUpDown2");
            stsw = $('.ui.checkbox').checkbox({
                onChange: function () {
                    var isChecked = $(this).is(':checked');
                    console.log('Toggle Switch state changed: ' + isChecked);
                    document.getElementById("master").innerHTML = isChecked ? numUpDown.val() : numUpDown2.val();
                }
            });
        });
        function downloadFile() {
            //get value of numUpDown
            var numUpDown = document.getElementById("numUpDown").value;
            //get value of numUpDown2
            var numUpDown2 = document.getElementById("numUpDown2").value;

            var fs = '`define size_minus_1(x) (x-1)';
            var matrix_size_1 = numUpDown;//100;
            var matrix_size_2 = numUpDown2;//400;
            var hedder_0 = '`define size_minus_1(x) (x-1)';
            var hedder_1 = '`define matrix_size_1 ';
            var hedder_2 = '`define matrix_size_2 ';
            var hedder_3 = '`define vector_size `matrix_size_1';
            var hedder_4 = hedder_0 + '\n' + hedder_1 + String(matrix_size_1) + '\n' + hedder_2 + String(matrix_size_2) + '\n' + hedder_3 + '\n';
            var hedder_5 = `module vector_add_vector_genED_${stsw[0].classList.contains('checked') ? 'X' : 'M'}_${matrix_size_1}_${matrix_size_2}_${stsw[0].classList.contains('checked') ? 'V' : 'X'}_${stsw[0].classList.contains('checked') ? matrix_size_1 : matrix_size_2} (`;
            var hedder_6 = `input logic signed [31:0] a[0:\`size_minus_1(\`${stsw[0].classList.contains('checked') ? 'vector_size' : 'matrix_size_2'})],`;
            var hedder_7 = `input logic signed [31:0] b[0:\`size_minus_1(\`${stsw[0].classList.contains('checked') ? 'vector_size' : 'matrix_size_2'})],`;
            var hedder_8 = `output logic signed [31:0] result[0:\`size_minus_1(\`${stsw[0].classList.contains('checked') ? 'vector_size' : 'matrix_size_2'})]`;
            var hedder_9 = ');';
            var hedder_10 = hedder_4 + '\n' + hedder_5 + '\n' + hedder_6 + '\n' + hedder_7 + '\n' + hedder_8 + '\n' + hedder_9 + '\n';
            var content = hedder_10;

            for (let index = 0; index < (stsw[0].classList.contains('checked') ? matrix_size_1 : matrix_size_2); index++) {
                var tmp = `assign result[${index}] = `;
                //for (let j = 0; j < matrix_size_1; j++) {
                tmp += `a[${index}] + b[${index}]`;
                //}
                tmp += ';\n';
                content += tmp;
            }

            content += '\nendmodule\n';

            var element = document.createElement('a');
            element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(content));
            element.setAttribute('download', `vector_add_vector_genED_${stsw[0].classList.contains('checked') ? 'X' : 'M'}_${matrix_size_1}_${matrix_size_2}_${stsw[0].classList.contains('checked') ? 'V' : 'X'}_${stsw[0].classList.contains('checked') ? matrix_size_1 : matrix_size_2}.sv`);
            element.style.display = 'none';
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        }
    </script>
</body>

</html>